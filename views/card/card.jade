extends ../layout

append scripts
  script(type="text/javascript", src="/javascripts/jquery.qrcode.min.js")
  script.
    var vcard = JSON.parse('!{vcard}');
    $(function () {
      var cardId = (window.location.href).split('/').pop();
      var url = window.location.href;
      if (/^localhost/.test(window.location.host)) url = 'http://192.168.1.3:8080/card/' + cardId;
      var size = 200;
      console.log(window.location.href);
      $('#qrcode').qrcode({
        width: size,
        height: size,
        text: url
      });
    });

//- text: "http://192.168.1.3:8080/card/" + cardId

block content
  .container
    if vcard && typeof vcard == 'string'
      - var card = JSON.parse(vcard)
      .row
        .col-xs-12.contact
          h2.title
            | #{card.name}
            span= card.position
          p.company= card.company
          ul
            li
              i.fa.fa-fw.fa-phone
              | #{card.phone}
            li
              i.fa.fa-fw.fa-email
              | #{card.site}
            li.address
              i.fa.fa-fw.fa-map-marker
              | #{card.address}
      .text-center
        #qrcode

    else
      p 卡片不存在